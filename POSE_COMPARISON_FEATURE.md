# 姿态对比与动作分析功能说明

## 功能概述

为sports-vision-cloud项目的实时训练监测功能添加了双画面姿态对比和动作分析匹配表功能。

## 新增功能

### 1. 双画面姿态对比

在演示模式下，用户可以切换到"双画面对比"视图，实时对比：
- **训练动作（左侧）**：显示用户当前的实时训练动作
- **标准动作（右侧）**：显示专业羽毛球标准动作参考
- **实时评分**：显示当前动作与标准动作的匹配分数

### 2. 实时动作分析匹配表

基于DTW（Dynamic Time Warping）算法的姿态匹配评价系统：
- 显示10种常见羽毛球动作的匹配数据
- 包含：序号、动作名称、相似度距离、分值、匹配进度
- 根据用户等级（demo1/2/3）动态调整评分范围

### 3. 动作类型

系统包含以下10种羽毛球标准动作：
1. 高远球 - 83.472分
2. 挑球 - 79.872分
3. 接杀球 - 92.936分
4. 平高球 - 87.873分
5. 放网前球 - 86.655分
6. 平抽挡球 - 91.240分
7. 正手扑球 - 88.339分
8. 正手勾球 - 87.642分
9. 正手准球 - 88.809分
10. 正手吊球 - 85.910分

## 文件结构

```
frontend/src/
├── pages/
│   └── Training.tsx                              # 主训练页面（已更新）
├── components/
│   └── PoseViewer/
│       ├── PoseComparisonView.tsx               # 双画面对比组件
│       └── ActionMatchingTable.tsx              # 动作匹配表组件
└── utils/
    └── standardActions.ts                       # 标准动作数据
```

## 使用方法

### 步骤1：启动演示模式
1. 打开训练页面
2. 点击"演示模式"按钮
3. 系统自动开始姿态追踪演示

### 步骤2：切换视图
演示模式下，页面顶部会显示两个标签：
- **单画面姿态**：传统的单一3D姿态视图
- **双画面对比**：新增的对比视图

### 步骤3：查看分析数据
在"双画面对比"标签下：
1. 上方显示训练动作和标准动作的3D对比
2. 右上角显示实时匹配分数
3. 下方显示完整的动作分析匹配表

## 用户等级差异化

系统根据登录用户的等级自动调整评分范围：

| 用户等级 | 用户名 | 评分范围 | 特点 |
|---------|--------|---------|------|
| 业余入门 | demo1 | 65-80分 | 较低的起始分数 |
| 业余高手 | demo2 | 75-88分 | 中等水平评分 |
| 职业选手 | demo3 | 85-95分 | 高水平评分 |

## 技术特点

### 1. 组件化设计
- **PoseComparisonView**: 独立的双画面3D渲染组件
- **ActionMatchingTable**: 可复用的表格展示组件
- 遵循React组件最佳实践，易于维护和扩展

### 2. 确定性数据生成
使用种子随机数生成器，确保每个用户每次看到的演示数据一致，便于演示和调试。

### 3. 响应式设计
- 单画面模式：左侧姿态（14栏）+ 右侧指标（10栏）
- 双画面模式：全宽显示（24栏），最大化对比视觉效果

### 4. 实时更新
- 动作每30帧自动切换（约1.5秒）
- 匹配表实时更新对应的标准动作数据
- 分数根据用户水平动态调整

## 数据格式

### ActionMatchData接口
```typescript
interface ActionMatchData {
  sequence: number          // 序号
  actionName: string       // 动作名称
  similarity: number       // 相似度 (0-1)
  distance: number         // DTW距离
  score: number           // 分值 (0-100)
  standardPose: number[][] // 标准姿态17关键点数据
}
```

### 姿态数据格式
17关键点COCO格式（YOLOv11-Pose标准）：
```
0:鼻子 1:左眼 2:右眼 3:左耳 4:右耳
5:左肩 6:右肩 7:左肘 8:右肘 9:左腕 10:右腕
11:左髋 12:右髋 13:左膝 14:右膝 15:左踝 16:右踝
```

每个关键点：`[x, y, z, confidence]`

## 演示账户

系统预置了三个演示账户，对应不同水平：

| 用户名 | 密码 | 水平 | 说明 |
|-------|------|------|------|
| demo1 | any  | 业余入门 | 基础训练者，分数较低 |
| demo2 | any  | 业余高手 | 中级训练者，分数中等 |
| demo3 | any  | 职业选手 | 专业运动员，高分表现 |

## 未来扩展

### 可能的改进方向：
1. 添加更多动作类型（杀球、网前搓球等）
2. 支持自定义标准动作录制
3. 添加动作细节分析（关节角度、速度等）
4. 历史动作回放和对比
5. 多人动作对比
6. 导出训练报告

## 注意事项

1. 此功能仅在**演示模式**下可用
2. 实际训练模式保持原有单画面视图
3. 标准动作数据基于理想化模型，实际应用需根据具体需求调整
4. 3D渲染需要较好的显卡支持，低端设备可能出现卡顿

## 兼容性

- **浏览器**: Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **Node.js**: 16.x+
- **React**: 18.x
- **Three.js**: React Three Fiber 8.x

## 维护和支持

如遇问题或有改进建议，请联系开发团队或提交Issue。
